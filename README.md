# conan-gstreamer

Conan build for gstreamer, run the command to build a project.

The build order is as below:

-   gstreamer-build-tools  
    [ ![Download](https://api.bintray.com/packages/yjjnls/stable/gstreamer-build-tools%3Ayjjnls/images/download.svg) ](https://bintray.com/yjjnls/stable/gstreamer-build-tools%3Ayjjnls/_latestVersion)  
    Gstreamer build tools generated by boostrap

-   gstreamer-runtime  
    [ ![Download](https://api.bintray.com/packages/yjjnls/stable/gstreamer-runtime%3Ayjjnls/images/download.svg) ](https://bintray.com/yjjnls/stable/gstreamer-runtime%3Ayjjnls/_latestVersion)  
    Gstreamer-1.0 runtime library

-   gstreamer-dev  
    [ ![Download](https://api.bintray.com/packages/yjjnls/stable/gstreamer-dev%3Ayjjnls/images/download.svg) ](https://bintray.com/yjjnls/stable/gstreamer-dev%3Ayjjnls/_latestVersion)  
    Gstreamer-1.0 development library

-   gstreamer-custom  
    [ ![Download](https://api.bintray.com/packages/yjjnls/stable/gstreamer-custom%3Ayjjnls/images/download.svg) ](https://bintray.com/yjjnls/stable/gstreamer-custom%3Ayjjnls/_latestVersion)  
    Custom modified libraries, including gst-rtsp-server-1.0, dtls, webrtc

# How to build

## linux
### pre-work
* Gstreamer should be built in the docker `lasote/conangcc49` using gcc4.9. Here's the steps:

```bash
# download the docker image
$ git pull lasote/conangcc49

# the first time to run the image
$ sudo docker run -it lasote/conangcc49 /bin/bash

# or you can use the commands below once you have creaed a container using the command above
$ sudo docker start container_id
$ sudo docker exec -it container_id /bin/bash

# update the environment, it may be very slow and vpn may be required
$ sudo apt-get -y update
$ sudo apt-get -y upgrade
$ sudo apt-get install -y build-essential
$ git config --global user.name "xxx"
$ git config --global user.email "xxxx"
```


### build
gstreamer-runtime, gstreamer-dev, and gstreamer-custom require dependies. They will use the pre-built package in your own bintray defaultly.   

If you want to use the other pre-built packages, set `DEPENDENT_BINTRAY_REPO` in your environment. `DEPENDENT_BINTRAY_REPO` is the bintray username, if not set, it's same as `CONAN_USERNAME`.


    $ cd $project
    $ sudo python build.py

The gstreamer library will be installed to the directory `~/gstreamer/linux_x86_64`.

If you want to develop your own library based on the gstreamer-1.0, run the commond to load the environment:

    $ cd ~/gstreamer/linux_x86_64
    $ source tshell.sh

## windows
not supported
<!-- 
### pre-work

The initial setup on Windows is a little bit longer, but only a few programs are required.

-   Python2.7: <https://www.python.org/downloads/>
     IMPORTANT : Chose the 2.7 version. The 3.x versions are _not_ supported
-   CMake: <http://www.cmake.org/cmake/resources/software.html>
-   Git: <http://git-scm.com/download/win>
     IMPORTANT: Select the install option "Checkout as-is, Commit as-is"
-   Msys/MinGW: <http://sourceforge.net/projects/mingw/files/Installer/mingw-get-setup.exe/download>
       Install it with all the options enabled, you can also select the package below in `Basic Setup` for minimum installation:
       * mingw-developer-toolkit
       * mingw32-base
       * msys-base


**cerbero must be run in the `MingGW shell`, which is accessible from the main menu or desktop (if it is not, go to Mingw Installation manager, select MSYS Base Development and install msys-bash  lnk).**

The last step is making python and git available from the shell, for which you will need to create a .profile file:

If you use 64-bit Windows, please execute:

    $ echo 'export PATH="$PATH:/c/Python27:/c/Program Files/Git/bin:/c/MinGW/bin/"' > ~/.profile

If you use 32-bit Windows, please execute:

    $ echo 'export PATH="$PATH:/c/Python27:/c/Program Files (x86)/Git/bin:/c/MinGW/bin/"' > ~/.profile

### 64-bit build

    $ export CONAN_ARCHS=x86_64
    $ export CONAN_BASH_PATH="C:\MinGW\msys\1.0\bin\sh.exe"

    set CONAN_ARCHS=x86_64
    set CONAN_BASH_PATH=C:\MinGW\msys\1.0\bin\sh.exe -->
